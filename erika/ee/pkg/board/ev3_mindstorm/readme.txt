Note that this code here is just modified to fit my style of coding. Other than that it is a shameless grap of the ninjastormos.